barplot(grupos1$pageranks, grupos1$labels)
str(grafo)
barplot(grafo$pageranks, grafo1$labels)
View(grafo)
barplot(grafo$pageranks, grafo1$label)
grafo <- read.csv("grafointeligivel.csv", sep=";")
grupos <- group_by(grafo, modularity_class) %>% summarise(n=n())
grupos1 <- group_by(grafo, modularity_class)
ggplot(grupos1, aes(modularity_class, betweenesscentrality
,label=label)) + geom_point() + geom_text(check_overlap = TRUE)
barplot(grafo$pageranks, grafo$label)
ggplot(grupos1, aes(label, pageranks)) + geom_bar(stat = "identity")
ggplot2(grupos1, aes(label, pageranks)) + geom_bar(stat = "identity")
ggplot(grupos1, aes(label, pageranks)) + geom_bar(stat = "identity") + geom_text(check_overlap = TRUE)
ggplot(grupos1, aes(label, pageranks, label = label)) + geom_bar(stat = "identity") + geom_text(check_overlap = TRUE)
ggplot(grupos1, aes(pageranks, label = label)) + geom_bar(stat = "identity") + geom_text(check_overlap = TRUE)
ggplot(grupos1, aes(pageranks)) + geom_bar(stat = "identity")
ggplot(grupos1, aes(label, pageranks)) + geom_bar(stat = "identity")
ggplot(grupos1, aes(modularity_class, pageranks)) + geom_bar(stat = "identity")
grupos <- group_by(grafo, modularity_class) %>% summarise(mean(pageranks))
View(grupos)
grupos <- group_by(grafo, modularity_class) %>% summarise(mean(betweenesscentrality))
View(grupos)
ggplot(grafo, aes(modularity_class, pageranks)) + geom_bar(stat = "identity")
ggplot(grafo, aes(betweenesscentrality, pageranks)) + geom_bar(stat = "identity")
plot(grafo$betweenesscentrality, grafo$pageranks)
ggplot(grupos1, aes(modularity_class, betweenesscentrality
,label=label)) + geom_point() + geom_text(check_overlap = TRUE)
ggplot(grafo, aes(betweenesscentrality, pageranks)) + geom_bar(stat = "identity")
plot(grafo$betweenesscentrality, grafo$pageranks)
ggplot(grupos1, aes(modularity_class, betweenesscentrality
,label=label)) + geom_point() + geom_text(check_overlap = TRUE)
ggplot(grafo, aes(betweenesscentrality, pageranks)) + geom_bar(stat = "identity")
ggplot(grafo, aes(label, pageranks)) + geom_bar(stat = "identity")
ggplot(grafo, aes(label, pageranks), xaxt ='n') + geom_bar(stat = "identity")
ggplot(grafo, aes(label, pageranks), xaxt ='n', ann = FALSE) + geom_bar(stat = "identity")
ggplot(grafo, aes(label, pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo, aes(label, pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo <- grafo[order(pageranks),]
grafo <- grafo[order(grafo$pageranks),]
ggplot(grafo, aes(label, pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo, aes(label, pageranks,
x=reorder(pageranks,pageranks,
ggplot(grafo, aes(label, pageranks,
x=reorder(pageranks,pageranks,
function(x)-length(x)))) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo, aes(label, pageranks,
ggplot(grafo, aes(label, pageranks,
x=reorder(pageranks,pageranks,
function(x)-length(x)))) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo, aes(label, pageranks) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo, aes(label, pageranks) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
ggplot(grafo, aes(label, pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo, aes(label, pageranks, reorder(x = factor(pageranks)))) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo, aes(label, pageranks, reorder(x = factor(labels)))) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
factor(grafo$pageranks)
ggplot(grafo, aes(label, pageranks, reorder(factor(labels)))) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo$label <- factor(grafo$label, levels = grafo$label[order(grafo$label)])
ggplot(grafo, aes(label, pageranks, reorder(factor(labels)))) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo, aes(x = label, y = pageranks) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo, aes(x = label, y = pageranks) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
grafo$label <- factor(grafo$label, levels = grafo$label[order(grafo$label)])
ggplot(grafo, aes(x = label, y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo$label
grafo$label <- factor(grafo$label, levels = grafo$label[order(grafo$label)])
ggplot(grafo, aes(x = label, y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo$label <- factor(grafo$label, levels = grafo$label[order(grafo$label)])
ggplot(grafo, aes(x = label, y = pageranks)) + geom_bar(stat = "identity")
ggplot(grafo, aes(x = label, y = pageranks)) + theme_bw() + geom_bar(stat = "identity")
grafo$label <- factor(grafo$label, levels = grafo$label[order(grafo$label)])
ggplot(grafo, aes(x = label, y = pageranks)) + theme_bw() + geom_bar(stat = "identity")
ggplot(grafo, aes(x = label, y = pageranks)) + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
+ geom_bar(stat = "identity")
ggplot(grafo, aes(x = label, y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo$label
ggplot(grafo, aes(x = label, y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo$label <- factor(grafo$label, levels = grafo$label[order(grafo$label)])
ggplot(grafo, aes(x = label, y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo, aes(x = pageranks, y = label)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
label
grafo$label <- factor(grafo$label, levels = grafo$label[order(grafo$label)])
ggplot(grafo, aes(x = label, y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo[33]
grafo[33,]
grafo[28:33,]
ggplot(grafo[28:33,], aes(x = label, y = pageranks)) + geom_bar(stat = "identity")
#Inserts newlines into strings every N interval
new_lines_adder = function(test.string, interval){
#length of str
string.length = nchar(test.string)
#split by N char intervals
split.starts = seq(1,string.length,interval)
split.ends = c(split.starts[-1]-1,nchar(test.string))
#split it
test.string = substring(test.string, split.starts, split.ends)
#put it back together with newlines
test.string = paste0(test.string,collapse = "\n")
return(test.string)
}
#a user-level wrapper that also works on character vectors, data.frames, matrices and factors
add_newlines = function(x, interval) {
if (class(x) == "data.frame" | class(x) == "matrix" | class(x) == "factor") {
x = as.vector(x)
}
if (length(x) == 1) {
return(new_lines_adder(x, interval))
} else {
t = sapply(x, FUN = new_lines_adder, interval = interval) #apply splitter to each
names(t) = NULL #remove names
return(t)
}
}
ggplot(grafo[28:33,], aes(x = label, y = pageranks)) + geom_bar(stat = "identity")  +
scale_x_discrete(labels = add_newlines(test.data$text, 20), name = "")
ggplot(grafo[28:33,], aes(x = label, y = pageranks)) + geom_bar(stat = "identity")  +
scale_x_discrete(labels = add_newlines(grafo$label, 20), name = "")
ggplot(grafo[28:33,], aes(x = label, y = pageranks)) + geom_bar(stat = "identity")  +
scale_x_discrete(labels = add_newlines(grafo$label, 5), name = "")
ggplot(grafo[28:33,], aes(x = label, y = pageranks)) + geom_bar(stat = "identity")  +
scale_x_discrete(labels = add_newlines(grafo$label, 10), name = "")
ggplot(grafo[28:33,], aes(x = label, y = pageranks)) + geom_bar(stat = "identity")  +
scale_x_discrete(labels = add_newlines(grafo$label, 12), name = "")
ggplot(grafo, aes(x = label, y = betweenesscentrality)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo[28:33,], aes(x = label, y = pageranks)) + geom_bar(stat = "identity")  +
scale_x_discrete(labels = add_newlines(grafo$label, 12), name = "")
grafo[28:33,]
ggplot(grafo[28:33,], aes(x = label, y = pageranks)) + geom_bar(stat = "identity")  +
scale_x_discrete(labels = add_newlines(grafo[28:33]$label, 12), name = "")
grafo2 <- grafo[28:33,]
View(grafo2)
ggplot(grafo2, aes(x = label, y = pageranks)) + geom_bar(stat = "identity")  +
grafo2 <- grafo[28:33,]
ggplot(grafo2, aes(x = label, y = pageranks)) + geom_bar(stat = "identity")  +
scale_x_discrete(labels = add_newlines(grafo2$label, 12), name = "")
grafo2 <- grafo[28:33,]
ggplot(grafo2, aes(x = label, y = pageranks)) + geom_bar(stat = "identity")
grafo2 <- grafo[28:33,]
ggplot(grafo2, aes(x = label, y = pageranks)) + geom_bar(stat = "identity")
+ scale_x_discrete(labels = add_newlines(grafo2$label, 12), name = "")
grafo2 <- grafo[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity")
ggplot(grafo, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
library(dplyr)
library(ggplot2)
options(encoding = "UTF-8")
grafo <- read.csv("grafointeligivel.csv", sep=";")
grupos <- group_by(grafo, modularity_class) %>% summarise(mean(betweenesscentrality))
grupos1 <- group_by(grafo, modularity_class)
library(dplyr)
library(ggplot2)
options(encoding = "UTF-8")
grafo <- read.csv("grafointeligivel.csv", sep=";")
grupos <- group_by(grafo, modularity_class) %>% summarise(mean(betweenesscentrality))
grupos1 <- group_by(grafo, modularity_class)
ggplot(grupos1, aes(modularity_class, betweenesscentrality
,label=label)) + geom_point() + geom_text(check_overlap = TRUE)
grafo2 <- grafo
grafo2$label <- factor(grafo$label, levels = grafo$label[order(grafo$label)])
View(grafo)
View(grafo2)
ggplot(grafo, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity")
ggplot(grafo, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo3 <- grafo
grafo3$label <- factor(grafo$label, levels = grafo$label[order(grafo$label)])
grafo3 <- grafo3[28:22,]
ggplot(grafo[28:33,], aes(x = label, y = pageranks)) + geom_bar(stat = "identity")  +
scale_x_discrete(labels = add_newlines(grafo$label, 12), name = "")
ggplot(grafo[28:33,], aes(x = label, y = pageranks)) + geom_bar(stat = "identity")
grafo3 <- grafo
grafo3$label <- factor(grafo$label, levels = grafo$label[order(grafo$label)])
grafo3 <- grafo3[28:22,]
ggplot(grafo3, aes(x = label, y = pageranks)) + geom_bar(stat = "identity")
grafo3 <- grafo
grafo3$label <- factor(grafo$label, levels = grafo$label[order(grafo$label)])
grafo3 <- grafo3[28:33,]
ggplot(grafo3, aes(x = label, y = pageranks)) + geom_bar(stat = "identity")
grafo3 <- grafo3[29:33,]
ggplot(grafo3, aes(x = label, y = pageranks)) + geom_bar(stat = "identity")
grafo3 <- grafo
grafo3$label <- factor(grafo$label, levels = grafo$label[order(grafo$label)])
grafo3 <- grafo3[29:33,]
ggplot(grafo3, aes(x = label, y = pageranks)) + geom_bar(stat = "identity")
grafo2 <- grafo
grafo2$label <- factor(grafo$label, levels = grafo$label[order(grafo$pageranks)])
ggplot(grafo, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity")
grafo2 <- grafo2[28:33,]
View(grafo2)
grafo <- read.csv("grafointeligivel.csv", sep=";")
grupos <- group_by(grafo, modularity_class) %>% summarise(mean(betweenesscentrality))
grupos1 <- group_by(grafo, modularity_class)
grafo2 <- grafo
View(grafo2)
View(grafo)
grafo2$label <- factor(grafo2$label, levels = grafo2$label[order(grafo2$pageranks)])
View(grafo2)
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo2 <- grafo2[28:33,]
View(grafo2)
grafo2 <- grafo2$label[order(grafo2$pageranks),]
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
View(grafo2)
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity")
ggplot(grafo, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo3 <- grafo
grafo3$label <- factor(grafo$label, levels = grafo$label[order(grafo$betweenesscentrality)])
grafo3 <- grafo3[29:33,]
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")
grafo3 <- grafo
grafo3 <- grafo3[order(grafo3$betweenesscentrality),]
grafo3 <- grafo3[29:33,]
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")
View(grafo3)
grafo3 <- grafo
grafo3 <- grafo3[order(grafo3$betweenesscentrality),]
grafo3 <- grafo3[24:33,]
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity") + scale_x_discrete(labels = abbreviate)
#Inserts newlines into strings every N interval
new_lines_adder = function(test.string, interval){
#length of str
string.length = nchar(test.string)
#split by N char intervals
split.starts = seq(1,string.length,interval)
split.ends = c(split.starts[-1]-1,nchar(test.string))
#split it
test.string = substring(test.string, split.starts, split.ends)
#put it back together with newlines
test.string = paste0(test.string,collapse = "\n")
return(test.string)
}
#a user-level wrapper that also works on character vectors, data.frames, matrices and factors
add_newlines = function(x, interval) {
if (class(x) == "data.frame" | class(x) == "matrix" | class(x) == "factor") {
x = as.vector(x)
}
if (length(x) == 1) {
return(new_lines_adder(x, interval))
} else {
t = sapply(x, FUN = new_lines_adder, interval = interval) #apply splitter to each
names(t) = NULL #remove names
return(t)
}
}
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")+
scale_x_discrete(labels = add_newlines(test.data$text, 20), name = "")
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")+
scale_x_discrete(labels = add_newlines(grafo3$label, 10), name = "")
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")+
scale_x_discrete(labels = add_newlines(grafo3$label, 8), name = "")
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")+
scale_x_discrete(labels = add_newlines(grafo3$label, 6), name = "")
grafo3 <- grafo
grafo3 <- grafo3[order(grafo3$betweenesscentrality),]
grafo3 <- grafo3[29:33,]
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")+
scale_x_discrete(labels = add_newlines(grafo3$label, 10), name = "")
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")+
scale_x_discrete(labels = add_newlines(grafo3$label, 15), name = "")
ggplot(grafo, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())+
scale_x_discrete(labels = add_newlines(test.data$text, 20), name = "")
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 20), name = "")
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 20), name = "")
grafo3 <- grafo
grafo3 <- grafo3[order(grafo3$betweenesscentrality),]
grafo3 <- grafo3[29:33,]
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")+
scale_x_discrete(labels = add_newlines(grafo3$label, 15), name = "")
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 20), name = "")
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 15), name = "")
grafo2 <- grafo2[29:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 15), name = "")
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo2 <- grafo2[29:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 15), name = "")
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo2 <- grafo2[29:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 15), name = "")
ggplot(grafo, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo3 <- grafo
grafo3 <- grafo3[order(grafo3$betweenesscentrality),]
grafo3 <- grafo3[29:33,]
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")+
scale_x_discrete(labels = add_newlines(grafo3$label, 15), name = "")
grafo3 <- grafo3[1:5,]
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")+
scale_x_discrete(labels = add_newlines(grafo3$label, 15), name = "")
grafo3 <- grafo
grafo3 <- grafo3[order(grafo3$betweenesscentrality),]
grafo3 <- grafo3[1:5,]
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")+
scale_x_discrete(labels = add_newlines(grafo3$label, 15), name = "")
grafo2 <- grafo2[1:5,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 15), name = "")
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo2 <- grafo2[1:5,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 15), name = "")
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 15), name = "")
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 12), name = "")
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 10), name = "")
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 12), name = "")
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 13), name = "")
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + coord_fixed()
library(dplyr)
library(ggplot2)
options(encoding = "UTF-8")
#Inserts newlines into strings every N interval
new_lines_adder = function(test.string, interval){
#length of str
string.length = nchar(test.string)
#split by N char intervals
split.starts = seq(1,string.length,interval)
split.ends = c(split.starts[-1]-1,nchar(test.string))
#split it
test.string = substring(test.string, split.starts, split.ends)
#put it back together with newlines
test.string = paste0(test.string,collapse = "\n")
return(test.string)
}
#a user-level wrapper that also works on character vectors, data.frames, matrices and factors
add_newlines = function(x, interval) {
if (class(x) == "data.frame" | class(x) == "matrix" | class(x) == "factor") {
x = as.vector(x)
}
if (length(x) == 1) {
return(new_lines_adder(x, interval))
} else {
t = sapply(x, FUN = new_lines_adder, interval = interval) #apply splitter to each
names(t) = NULL #remove names
return(t)
}
}
grafo <- read.csv("grafointeligivel.csv", sep=";")
grupos <- group_by(grafo, modularity_class) %>% summarise(mean(betweenesscentrality))
grupos1 <- group_by(grafo, modularity_class)
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 13), name = "")
ggplot(grafo, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
grafo3 <- grafo
grafo3 <- grafo3[order(grafo3$betweenesscentrality),]
grafo3 <- grafo3[1:5,]
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")+
scale_x_discrete(labels = add_newlines(grafo3$label, 15), name = "")
grafo3 <- grafo
grafo3 <- grafo3[order(grafo3$betweenesscentrality),]
grafo3 <- grafo3[29:33,]
ggplot(grafo3, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality)) + geom_bar(stat = "identity")+
scale_x_discrete(labels = add_newlines(grafo3$label, 15), name = "")
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + coord_flip()
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + coord_flip()
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks, xlab="disciplinas")) + geom_bar(stat = "identity") + coord_flip()
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks, xlab="disciplinas")) + geom_bar(stat = "identity") + coord_flip()
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 13), name = "")
ggplot(grafo, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality, xlab("disciplinas"))) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks, xlab="disciplinas")) + geom_bar(stat = "identity") + coord_flip()
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks, xlab="disciplinas")) + geom_bar(stat = "identity") + coord_flip()
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + labs(x = "disciplinas") + coord_flip()
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + labs(x = "disciplinas") + coord_flip()
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 13), name = "")
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + labs(x = "disciplinas") + coord_flip()
grafo2 <- grafo2[28:33,]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") +
scale_x_discrete(labels = add_newlines(grafo2$label, 13), name = "")
ggplot(grafo, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality, xlab("disciplinas"))) + geom_bar(stat = "identity") + theme(axis.title.x=element_blank(),
axis.text.x=element_blank(),
axis.ticks.x=element_blank())
ggplot(grafo, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality, xlab("disciplinas"))) + geom_bar(stat = "identity") + labs(x = "disciplinas") + coord_flip()
grafo2 <- grafo
grafo2 <- grafo2[order(grafo2$pageranks),]
ggplot(grafo2, aes(x = reorder(label, pageranks), y = pageranks)) + geom_bar(stat = "identity") + labs(x = "disciplinas") + coord_flip()
ggplot(grafo, aes(x = reorder(label, betweenesscentrality), y = betweenesscentrality, xlab("disciplinas"))) + geom_bar(stat = "identity") + labs(x = "disciplinas") + coord_flip()
grafo3 <- grafo
